---
// import MagicNotifications from '../components/MagicNotifications.astro'; // Removed during cleanup
// import '../styles/globals.css'; // Comentado temporalmente

export interface Props {
  title?: string;
  description?: string;
  className?: string;
  logoUrl?: string;
  logoAlt?: string;
  ogImage?: string;
  ogImageAlt?: string;
}

// Obtener información del sitio para meta tags
let siteTitle = "Blixel";
let siteDescription = "Automatiza tu empresa con IA";

// COMENTADO: Este fetch puede causar problemas de recursión
// try {
//   const baseResponse = await fetch('https://blixel.es/wp-json/');
//   if (baseResponse.ok) {
//     const baseData = await baseResponse.json();
//     if (baseData.name) {
//       siteTitle = baseData.name;
//     }
//     if (baseData.description) {
//       siteDescription = baseData.description;
//     }
//   }
// } catch (error) {
//   // Usar valores por defecto si hay error
// }

const { 
  title = siteTitle, 
  description = siteDescription,
  className = '',
  logoUrl,
  logoAlt,
  ogImage,
  ogImageAlt = title
} = Astro.props;

// Construir título completo
const fullTitle = title === siteTitle ? siteTitle : `${title} | ${siteTitle}`;
---

<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{fullTitle}</title>
  <meta name="description" content={description}>
  
  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🚀</text></svg>">
  
  <!-- Meta tags adicionales -->
  <meta name="robots" content="index, follow">
  <meta name="author" content="Blixel">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:title" content={fullTitle}>
  <meta property="og:description" content={description}>
  <meta property="og:url" content="https://blixel.es">
  {ogImage && <meta property="og:image" content={ogImage} />}
  {ogImage && <meta property="og:image:alt" content={ogImageAlt} />}
  <meta property="og:site_name" content={siteTitle}>
  <meta property="og:locale" content="es_ES">
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content={fullTitle}>
  <meta name="twitter:description" content={description}>
  {ogImage && <meta name="twitter:image" content={ogImage} />}
  {ogImage && <meta name="twitter:image:alt" content={ogImageAlt} />}
  
  <!-- Preload fonts for better performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>
<body class={className}>
  <!-- Canvas de partículas modernas con tsParticles -->
  <div id="tsparticles"></div>
  
  <!-- Header removido para usar el de WordPress -->
  
  <!-- Contenido principal -->
  <main id="main-content">
    <slot />
  </main>
  
  <!-- Magic UI Notifications System -->
  <!-- MagicNotifications component removed during cleanup -->
  
  <!-- Sistema de partículas modernas con tsParticles -->
  <script>
    // Función para cargar tsParticles modernos y minimalistas
    async function loadTsParticles() {
      // Cargar tsParticles desde CDN
      if (!window.tsParticles) {
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/tsparticles-slim@2.12.0/tsparticles.slim.bundle.min.js';
        script.onload = initTsParticles;
        document.head.appendChild(script);
      } else {
        initTsParticles();
      }
    }

    // Configuración minimalista y moderna de tsParticles
    function initTsParticles() {
      tsParticles.load('tsparticles', {
        background: {
          color: {
            value: 'transparent',
          },
        },
        fpsLimit: 120,
        interactivity: {
          events: {
            onClick: {
              enable: true,
              mode: 'push',
            },
            onHover: {
              enable: true,
              mode: 'repulse',
            },
            resize: true,
          },
          modes: {
            push: {
              quantity: 2,
            },
            repulse: {
              distance: 80,
              duration: 0.4,
            },
          },
        },
        particles: {
          color: {
            value: ['#60a5fa', '#3b82f6', '#2563eb'],
          },
          links: {
            color: '#60a5fa',
            distance: 100,
            enable: true,
            opacity: 0.08,
            width: 1,
          },
          collisions: {
            enable: false,
          },
          move: {
            direction: 'none',
            enable: true,
            outModes: {
              default: 'bounce',
            },
            random: false,
            speed: 0.3,
            straight: false,
          },
          number: {
            density: {
              enable: true,
              area: 1500,
            },
            value: 25,
          },
          opacity: {
            value: 0.15,
            animation: {
              enable: true,
              speed: 0.8,
              minimumValue: 0.05,
              sync: false,
            },
          },
          shape: {
            type: 'circle',
          },
          size: {
            value: { min: 1, max: 2.5 },
            animation: {
              enable: true,
              speed: 1.5,
              minimumValue: 0.3,
              sync: false,
            },
          },
        },
        detectRetina: true,
      });
    }

    // Cargar al inicio
    document.addEventListener('DOMContentLoaded', loadTsParticles);
  </script>
</body>
</html>

<style is:global>
  /* Reset básico */
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  html {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    scroll-behavior: smooth;
  }

  body {
    line-height: 1.6;
    color: #e5e5e5;
    background-color: #000000;
    overflow-x: hidden;
    padding-top: 0; /* Sin header */
  }

  /* Layout principal */
  #main-content {
    min-height: calc(100vh - 200px);
  }



  /* Utilidades globales */
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 2rem;
  }

  .text-center {
    text-align: center;
  }

  .mb-2 { margin-bottom: 1rem; }
  .mb-4 { margin-bottom: 2rem; }
  .mt-2 { margin-top: 1rem; }
  .mt-4 { margin-top: 2rem; }

  /* Canvas de partículas modernas tsParticles */
  #tsparticles {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    background: linear-gradient(135deg, #000000 0%, #0a0a0a 50%, #000000 100%);
    pointer-events: none;
  }

  body {
    position: relative;
  }

  /* El contenido principal debe bloquear eventos del canvas */
  #main-content {
    pointer-events: auto;
    position: relative;
  }

  /* Asegurar fondo uniforme en todas las secciones */
  section {
    position: relative;
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
  }

  /* Main content transparente */
  #main-content {
    position: relative;
    background: transparent;
    z-index: 1;
  }




</style>
