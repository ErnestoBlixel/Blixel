---
import Layout from '../layouts/Layout.astro';

// 1) Define aquí tu query con comillas backtick (template literal)
const GQL = `
  query GetHome {
    paginaHome(id: "home", idType: URI) {
      title
      content
    }
  }
`;

// 2) Haz el fetch usando la variable de entorno
const graphqlUrl = import.meta.env.PUBLIC_WP_GRAPHQL_URL;
if (!graphqlUrl) {
  throw new Error('PUBLIC_WP_GRAPHQL_URL no está configurada');
}

const res = await fetch(graphqlUrl, {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ query: GQL })
});
if (!res.ok) throw new Error(`Error GraphQL: ${res.status}`);
const { data } = await res.json();

// 3) Extrae de "data" lo que necesites
const home = data.paginaHome;
---

<!-- 4) Ahora ya en el template puedes renderizar "home" -->
<Layout>
  <h1>{home.title}</h1>
  <div innerHTML={home.content} />
</Layout>
