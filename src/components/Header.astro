---
// Obtener logo desde la props o usar la URL conocida de tu logo
const { logoUrl, logoAlt, className = 'main-header' } = Astro.props;

// URL de tu logo desde WordPress
const blixelLogoUrl = logoUrl || 'https://cms.blixel.es/wp-content/uploads/2025/05/cropped-Copia-de-BLIXEL-STUDIO_logo-500500.png';
const logoAltText = logoAlt || 'BLIXEL logo';
---

<header class={className}>
  <div class="container">
    <!-- Logo y título -->
    <div class="logo-section">
      <a href="/" class="logo-link">
        <div class="logo">
          <img src={blixelLogoUrl} alt={logoAltText} class="logo-icon-img" />
        </div>
      </a>
    </div>

    <!-- Navegación principal -->
    <nav class="main-nav">
      <ul class="nav-menu">
        <li><a href="#intro" class="nav-link">¿Qué es IA?</a></li>
        <li><a href="#servicios" class="nav-link">Servicios</a></li>
        <li><a href="#metodo" class="nav-link">Metodología</a></li>
        <li><a href="#casos" class="nav-link">Casos</a></li>
        <li><a href="#faq" class="nav-link">FAQ</a></li>
      </ul>
    </nav>

    <!-- Botón CTA -->
    <div class="cta-section">
      <a href="#cta" class="cta-button">
        <span>Quiero mi plan de IA</span>
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </a>
    </div>

    <!-- Menú móvil -->
    <button class="mobile-menu-toggle" aria-label="Abrir menú" id="mobileToggle">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </div>

  <!-- Menú móvil desplegable -->
  <div class="mobile-menu" id="mobileMenu">
    <nav class="mobile-nav">
      <ul class="mobile-nav-menu">
        <li><a href="#intro" class="mobile-nav-link">¿Qué es IA?</a></li>
        <li><a href="#servicios" class="mobile-nav-link">Servicios</a></li>
        <li><a href="#metodo" class="mobile-nav-link">Metodología</a></li>
        <li><a href="#casos" class="mobile-nav-link">Casos</a></li>
        <li><a href="#faq" class="mobile-nav-link">FAQ</a></li>
      </ul>
      <div class="mobile-cta">
        <a href="#cta" class="mobile-cta-button">
          Quiero mi plan de IA
        </a>
      </div>
    </nav>
  </div>
</header>

<style>
  .main-header {
    background: rgba(13, 13, 13, 0.95);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    transition: all 0.3s ease;
    overflow: hidden;
  }

  .container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0.75rem 2rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 2rem;
    height: 90px;
  }

  .logo-section {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    position: relative;
  }

  .logo-link {
    text-decoration: none;
    color: inherit;
  }

  .logo {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .logo-icon-img {
    width: 65px;
    height: 65px;
    object-fit: contain;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
    transition: transform 0.3s ease;
    border-radius: 8px;
  }

  .logo-icon-img:hover {
    transform: scale(1.05);
  }

  /* Navegación principal */
  .main-nav {
    flex: 1;
    display: flex;
    justify-content: center;
  }

  .nav-menu {
    display: flex;
    list-style: none;
    margin: 0;
    padding: 0;
    gap: 2rem;
  }

  .nav-link {
    text-decoration: none;
    color: rgba(255, 255, 255, 0.85);
    font-weight: 500;
    padding: 0.75rem 1rem;
    position: relative;
    transition: all 0.3s ease;
    border-radius: 8px;
    font-size: 0.95rem;
  }

  .nav-link::before {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    width: 0;
    height: 2px;
    background: linear-gradient(135deg, #60a5fa 0%, #a855f7 100%);
    transition: all 0.3s ease;
    transform: translateX(-50%);
  }

  .nav-link:hover {
    color: #60a5fa;
    background: rgba(96, 165, 250, 0.05);
  }

  .nav-link:hover::before {
    width: 80%;
  }

  /* Botón CTA */
  .cta-section {
    display: flex;
    align-items: center;
  }

  .cta-button {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: linear-gradient(135deg, #60a5fa 0%, #a855f7 100%);
    color: white;
    text-decoration: none;
    padding: 0.75rem 1.5rem;
    border-radius: 12px;
    font-weight: 600;
    font-size: 0.875rem;
    transition: all 0.3s ease;
    border: none;
    overflow: hidden;
    position: relative;
  }

  .cta-button::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    transform: translateX(-100%);
    transition: transform 600ms ease;
  }

  .cta-button:hover::before {
    transform: translateX(100%);
  }

  .cta-button:hover {
    transform: translateY(-1px);
    box-shadow: 0 8px 25px rgba(96, 165, 250, 0.25);
  }

  .cta-button svg {
    transition: transform 200ms ease;
  }

  .cta-button:hover svg {
    transform: translateX(2px);
  }

  /* Menú móvil */
  .mobile-menu-toggle {
    display: none;
    flex-direction: column;
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.5rem;
    gap: 0.25rem;
    transition: all 0.3s ease;
  }

  .mobile-menu-toggle span {
    width: 25px;
    height: 3px;
    background: rgba(255, 255, 255, 0.9);
    border-radius: 2px;
    transition: all 0.3s ease;
  }

  .mobile-menu-toggle.active span:nth-child(1) {
    transform: rotate(45deg) translate(6px, 6px);
  }

  .mobile-menu-toggle.active span:nth-child(2) {
    opacity: 0;
  }

  .mobile-menu-toggle.active span:nth-child(3) {
    transform: rotate(-45deg) translate(6px, -6px);
  }

  .mobile-menu {
    display: none;
    background: rgba(13, 13, 13, 0.98);
    backdrop-filter: blur(20px);
    border-top: 1px solid rgba(255, 255, 255, 0.08);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
    opacity: 0;
    transform: translateY(-10px);
    transition: all 0.3s ease;
  }

  .mobile-menu.active {
    opacity: 1;
    transform: translateY(0);
  }

  .mobile-nav {
    max-width: 1400px;
    margin: 0 auto;
    padding: 1.5rem 2rem;
  }

  .mobile-nav-menu {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .mobile-nav-link {
    text-decoration: none;
    color: rgba(255, 255, 255, 0.85);
    font-weight: 500;
    padding: 1rem 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
    transition: all 0.3s ease;
    display: block;
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.02);
    backdrop-filter: blur(8px);
  }

  .mobile-nav-link:hover {
    color: #60a5fa;
    border-color: rgba(96, 165, 250, 0.2);
    background: rgba(96, 165, 250, 0.05);
  }

  .mobile-cta {
    margin-top: 2rem;
    text-align: center;
  }

  .mobile-cta-button {
    background: linear-gradient(135deg, #60a5fa 0%, #a855f7 100%);
    color: white;
    text-decoration: none;
    padding: 1rem 2rem;
    border-radius: 12px;
    font-weight: 600;
    display: inline-block;
    transition: all 0.3s ease;
    border: none;
    width: 100%;
    text-align: center;
  }

  .mobile-cta-button:hover {
    transform: translateY(-1px);
    box-shadow: 0 8px 25px rgba(96, 165, 250, 0.25);
  }

  /* Efecto de scroll en header */
  .main-header.scrolled {
    background: rgba(13, 13, 13, 0.98);
    backdrop-filter: blur(30px);
    box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
  }

  /* Responsive */
  @media (max-width: 1024px) {
    .nav-menu {
      gap: 1.5rem;
    }

    .nav-link {
      padding: 0.5rem 0.75rem;
      font-size: 0.9rem;
    }
  }

  @media (max-width: 768px) {
    .container {
      padding: 1rem;
    }

    .main-nav {
      display: none;
    }

    .cta-section {
      display: none;
    }

    .mobile-menu-toggle {
      display: flex;
    }

    .logo-icon-img {
      width: 50px;
      height: 50px;
    }
  }

  @media (max-width: 480px) {
    .container {
      gap: 1rem;
    }

    .logo {
      gap: 0.5rem;
    }

    .logo-icon-img {
      width: 45px;
      height: 45px;
    }

    .mobile-nav {
      padding: 1rem;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Funcionalidad del menú móvil
    const toggle = document.getElementById('mobileToggle');
    const mobileMenu = document.getElementById('mobileMenu');
    
    if (toggle && mobileMenu) {
      toggle.addEventListener('click', function() {
        const isOpen = mobileMenu.style.display === 'block';
        
        if (isOpen) {
          mobileMenu.classList.remove('active');
          setTimeout(() => {
            mobileMenu.style.display = 'none';
          }, 300);
        } else {
          mobileMenu.style.display = 'block';
          setTimeout(() => {
            mobileMenu.classList.add('active');
          }, 10);
        }
        
        toggle.classList.toggle('active');
      });
    }

    // Cerrar menú móvil al hacer click en un enlace
    const mobileLinks = document.querySelectorAll('.mobile-nav-link, .mobile-cta-button');
    mobileLinks.forEach(link => {
      link.addEventListener('click', () => {
        if (mobileMenu && toggle) {
          mobileMenu.classList.remove('active');
          setTimeout(() => {
            mobileMenu.style.display = 'none';
          }, 300);
          toggle.classList.remove('active');
        }
      });
    });

    // Efecto de scroll en header
    const header = document.querySelector('.main-header');
    let scrolled = false;

    function updateHeader() {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      
      if (scrollTop > 100 && !scrolled) {
        header?.classList.add('scrolled');
        scrolled = true;
      } else if (scrollTop <= 100 && scrolled) {
        header?.classList.remove('scrolled');
        scrolled = false;
      }
    }

    // Throttle scroll events para mejor performance
    let ticking = false;
    function onScroll() {
      if (!ticking) {
        requestAnimationFrame(() => {
          updateHeader();
          ticking = false;
        });
        ticking = true;
      }
    }

    window.addEventListener('scroll', onScroll);

    // Smooth scroll para enlaces internos
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          const headerHeight = header?.offsetHeight || 90;
          const targetPosition = target.offsetTop - headerHeight - 20;
          
          window.scrollTo({
            top: targetPosition,
            behavior: 'smooth'
          });
        }
      });
    });

    // Highlight del enlace activo
    function updateActiveLink() {
      const sections = document.querySelectorAll('section[id]');
      const navLinks = document.querySelectorAll('.nav-link, .mobile-nav-link');
      const scrollPos = window.scrollY + 150;

      sections.forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.offsetHeight;
        const sectionId = section.getAttribute('id');

        if (scrollPos >= sectionTop && scrollPos < sectionTop + sectionHeight) {
          navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === `#${sectionId}`) {
              link.classList.add('active');
            }
          });
        }
      });
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink(); // Ejecutar al cargar
  });
</script>

<style>
  /* Estilo para enlace activo */
  .nav-link.active {
    color: #60a5fa;
    background: rgba(96, 165, 250, 0.1);
  }

  .nav-link.active::before {
    width: 80%;
  }

  .mobile-nav-link.active {
    color: #60a5fa;
    border-color: rgba(96, 165, 250, 0.3);
    background: rgba(96, 165, 250, 0.1);
  }
</style>
